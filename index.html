<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CUEVA - Sistema de Trazabilidad</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Arial, sans-serif;
            background: linear-gradient(135deg, #1B2951 0%, #334155 100%);
            min-height: 100vh;
            padding: 15px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .container {
            max-width: 500px;
            width: 100%;
            background: white;
            border-radius: 20px;
            overflow: hidden;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.4);
            animation: slideIn 0.5s ease-out;
        }
        
        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        .header {
            background: linear-gradient(135deg, #1B2951 0%, #00D4AA 100%);
            color: white;
            padding: 30px 20px;
            text-align: center;
            position: relative;
            overflow: hidden;
        }
        
        .header::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(255,255,255,0.1) 0%, transparent 70%);
            animation: pulse 3s ease-in-out infinite;
        }
        
        @keyframes pulse {
            0%, 100% { transform: scale(1); opacity: 0.3; }
            50% { transform: scale(1.1); opacity: 0.5; }
        }

        .header-logo {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 12px;
            margin-bottom: 10px;
            position: relative;
            z-index: 1;
        }

        .logo-symbol {
            width: 50px;
            height: 50px;
            position: relative;
        }

        .logo-circle {
            width: 50px;
            height: 50px;
            border: 2.5px solid white;
            border-radius: 50%;
            position: absolute;
            animation: logoMorph 6s ease-in-out infinite;
        }

        @keyframes logoMorph {
            0%, 100% { border-radius: 50%; }
            33% { border-radius: 25% 75%; }
            66% { border-radius: 75% 25%; }
        }

        .logo-element {
            position: absolute;
            background: transparent;
            animation: logoFloat 8s ease-in-out infinite;
        }

        @keyframes logoFloat {
            0%, 100% { transform: translate(0, 0) scale(1); }
            25% { transform: translate(2px, -2px) scale(1.1); }
            50% { transform: translate(-2px, 2px) scale(0.9); }
            75% { transform: translate(1px, 1px) scale(1.05); }
        }
        
        .header h1 {
            font-size: 36px;
            font-weight: 900;
            letter-spacing: 2px;
            position: relative;
            z-index: 1;
        }
        
        .header p {
            font-size: 13px;
            opacity: 0.95;
            font-weight: 600;
            position: relative;
            z-index: 1;
        }
        
        .content {
            padding: 20px;
        }
        
        .highlight-box {
            background: linear-gradient(135deg, #1B2951 0%, #2d3e63 100%);
            color: white;
            padding: 18px;
            border-radius: 12px;
            text-align: center;
            font-size: 22px;
            font-weight: 900;
            margin-bottom: 20px;
            letter-spacing: 1px;
            box-shadow: 0 4px 15px rgba(27, 41, 81, 0.3);
        }
        
        .section {
            background: #F1F5F9;
            border-radius: 15px;
            padding: 18px;
            margin-bottom: 15px;
            border: 2px solid #E2E8F0;
        }
        
        .section-title {
            font-size: 11px;
            font-weight: 800;
            color: #64748B;
            text-transform: uppercase;
            letter-spacing: 1.5px;
            margin-bottom: 12px;
            padding-bottom: 8px;
            border-bottom: 2px solid #00D4AA;
        }
        
        .info-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px 0;
            border-bottom: 1px solid #CBD5E1;
            font-size: 14px;
        }
        
        .info-row:last-child {
            border-bottom: none;
        }
        
        .label {
            font-weight: 700;
            color: #475569;
            display: flex;
            align-items: center;
            gap: 6px;
        }
        
        .label::before {
            content: '‚óè';
            color: #00D4AA;
            font-size: 10px;
        }
        
        .value {
            font-weight: 700;
            color: #1B2951;
            font-family: 'Courier New', monospace;
            text-align: right;
            word-break: break-word;
            max-width: 60%;
        }
        
        .uuid-box {
            background: white;
            border: 2px dashed #00D4AA;
            border-radius: 10px;
            padding: 12px;
            margin-top: 10px;
        }
        
        .uuid-value {
            font-size: 10px;
            color: #1B2951;
            font-family: 'Courier New', monospace;
            word-break: break-all;
            font-weight: 700;
            text-align: center;
        }

        .doc-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: 10px;
            margin-top: 12px;
        }

        .doc-button {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            background: linear-gradient(135deg, #0EA5E9 0%, #0284C7 100%);
            color: white;
            padding: 14px;
            border-radius: 10px;
            text-decoration: none;
            font-weight: 800;
            font-size: 14px;
            transition: all 0.3s ease;
            box-shadow: 0 4px 12px rgba(14, 165, 233, 0.3);
            border: none;
            cursor: pointer;
        }

        .doc-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 16px rgba(14, 165, 233, 0.4);
        }

        .doc-button.pdf {
            background: linear-gradient(135deg, #EF4444 0%, #DC2626 100%);
            box-shadow: 0 4px 12px rgba(239, 68, 68, 0.3);
        }

        .doc-button.pdf:hover {
            box-shadow: 0 6px 16px rgba(239, 68, 68, 0.4);
        }

        .doc-button.image {
            background: linear-gradient(135deg, #8B5CF6 0%, #7C3AED 100%);
            box-shadow: 0 4px 12px rgba(139, 92, 246, 0.3);
        }

        .doc-button.image:hover {
            box-shadow: 0 6px 16px rgba(139, 92, 246, 0.4);
        }

        .doc-icon {
            font-size: 18px;
        }
        
        .maps-button {
            display: block;
            width: 100%;
            background: linear-gradient(135deg, #00D4AA 0%, #00B894 100%);
            color: white;
            padding: 16px;
            border-radius: 12px;
            text-align: center;
            text-decoration: none;
            font-weight: 800;
            font-size: 16px;
            margin-top: 20px;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(0, 212, 170, 0.3);
        }
        
        .maps-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0, 212, 170, 0.4);
        }
        
        .maps-button::before {
            content: 'üìç ';
            font-size: 18px;
        }
        
        .footer {
            text-align: center;
            padding: 20px;
            color: #64748B;
            font-size: 11px;
            font-weight: 600;
        }
        
        .footer-logo {
            font-weight: 900;
            color: #1B2951;
            font-size: 13px;
            letter-spacing: 2px;
        }
        
        .loading {
            text-align: center;
            padding: 40px;
            color: white;
            font-size: 18px;
            font-weight: 700;
        }

        .warning {
            background: #FEF3C7;
            border-left: 4px solid #F59E0B;
            padding: 15px;
            margin: 15px 0;
            border-radius: 8px;
        }

        .warning-title {
            font-weight: 800;
            color: #92400E;
            margin-bottom: 8px;
        }

        .warning-text {
            font-size: 13px;
            color: #78350F;
            line-height: 1.5;
        }
        
        @media (max-width: 480px) {
            .header h1 {
                font-size: 28px;
            }
            
            .highlight-box {
                font-size: 18px;
            }
            
            .info-row {
                font-size: 13px;
            }

            .value {
                max-width: 50%;
                font-size: 12px;
            }

            .doc-button {
                font-size: 13px;
                padding: 12px;
            }
        }
    </style>
</head>
<body>
    <div class="container" id="app">
        <div class="loading">Cargando informaci√≥n...</div>
    </div>

    <script>
        function getParams() {
            const params = new URLSearchParams(window.location.search);
            return {
                proyecto: params.get('p') || '',
                tipo: params.get('t') || '',
                pieza: params.get('n') || '',
                fabricacion: params.get('f') || '',
                ubicacion: params.get('u') || '',
                posicionamiento: params.get('pos') || '',
                uuid: params.get('uuid') || '',
                fecha: params.get('fecha') || '',
                hora: params.get('hora') || '',
                generadoPor: params.get('gen') || '',
                cargo: params.get('cargo') || '',
                instalacion: params.get('inst') || '',
                mapsUrl: params.get('maps') || '',
                imagenGeneral: params.get('imgGen') || '',
                imagenDetalle: params.get('imgDet') || '',
                pdfMontaje: params.get('pdf') || ''
            };
        }

        function renderData() {
            const data = getParams();
            
            // Si NO hay par√°metros en absoluto, mostrar p√°gina de inicio
            if (!window.location.search || window.location.search === '?') {
                document.getElementById('app').innerHTML = `
                    <div class="header">
                        <div class="header-logo">
                            <div class="logo-symbol">
                                <div class="logo-circle"></div>
                                <svg width="50" height="50" viewBox="0 0 80 80" style="position: absolute; top: 0; left: 0;">
                                    <path d="M 15,15 L 18,13 L 21,15 L 21,19 L 18,21 L 15,19 Z" fill="none" stroke="#00D4AA" stroke-width="1.5"/>
                                    <path d="M 59,15 L 62,13 L 65,15 L 65,19 L 62,21 L 59,19 Z" fill="none" stroke="#FF6B4A" stroke-width="1.5"/>
                                    <rect x="28" y="28" width="12" height="12" fill="none" stroke="#0EA5E9" stroke-width="1.5"/>
                                    <rect x="45" y="45" width="15" height="7" fill="none" stroke="#F59E0B" stroke-width="1.5"/>
                                    <rect x="15" y="60" width="6" height="6" fill="none" stroke="#00D4AA" stroke-width="1.5"/>
                                    <path d="M 59,60 L 62,58 L 65,60 L 65,64 L 62,66 L 59,64 Z" fill="none" stroke="#FF6B4A" stroke-width="1.5"/>
                                </svg>
                            </div>
                            <h1>CUEVA</h1>
                        </div>
                        <p>Sistema de Trazabilidad</p>
                    </div>
                    <div class="content">
                        <div class="highlight-box">
                            Visor de Elementos Prefabricados
                        </div>
                        <div class="section">
                            <div class="section-title">Bienvenido</div>
                            <p style="text-align: center; padding: 20px; line-height: 1.6; color: #475569;">
                                Este es el visor de c√≥digos QR del sistema CUEVA.<br><br>
                                <strong>Para ver informaci√≥n de una pieza, escanea su c√≥digo QR.</strong>
                            </p>
                        </div>
                    </div>
                    <div class="footer">
                        <div class="footer-logo">CUEVA</div>
                        <div>Sistema Universal de Trazabilidad ¬© 2025</div>
                    </div>
                `;
                return;
            }

            // Si hay par√°metros pero est√°n vac√≠os o incompletos
            if (!data.proyecto || !data.pieza || !data.uuid) {
                document.getElementById('app').innerHTML = `
                    <div class="header">
                        <div class="header-logo">
                            <div class="logo-symbol">
                                <div class="logo-circle"></div>
                                <svg width="50" height="50" viewBox="0 0 80 80" style="position: absolute; top: 0; left: 0;">
                                    <path d="M 15,15 L 18,13 L 21,15 L 21,19 L 18,21 L 15,19 Z" fill="none" stroke="#00D4AA" stroke-width="1.5"/>
                                    <path d="M 59,15 L 62,13 L 65,15 L 65,19 L 62,21 L 59,19 Z" fill="none" stroke="#FF6B4A" stroke-width="1.5"/>
                                    <rect x="28" y="28" width="12" height="12" fill="none" stroke="#0EA5E9" stroke-width="1.5"/>
                                    <rect x="45" y="45" width="15" height="7" fill="none" stroke="#F59E0B" stroke-width="1.5"/>
                                    <rect x="15" y="60" width="6" height="6" fill="none" stroke="#00D4AA" stroke-width="1.5"/>
                                    <path d="M 59,60 L 62,58 L 65,60 L 65,64 L 62,66 L 59,64 Z" fill="none" stroke="#FF6B4A" stroke-width="1.5"/>
                                </svg>
                            </div>
                            <h1>CUEVA</h1>
                        </div>
                        <p>Sistema de Trazabilidad</p>
                    </div>
                    <div class="content">
                        <div class="warning">
                            <div class="warning-title">‚ö†Ô∏è C√≥digo QR Antiguo o Inv√°lido</div>
                            <div class="warning-text">
                                Este c√≥digo QR puede ser de una versi√≥n anterior del sistema o contiene datos incompletos.<br><br>
                                <strong>Soluci√≥n:</strong> Genera nuevos c√≥digos QR desde la aplicaci√≥n CUEVA QR Generator.<br><br>
                                <strong>UUID detectado:</strong> ${data.uuid || 'No disponible'}
                            </div>
                        </div>
                    </div>
                    <div class="footer">
                        <div class="footer-logo">CUEVA</div>
                        <div>Sistema Universal de Trazabilidad ¬© 2025</div>
                    </div>
                `;
                return;
            }

            // Validar y limpiar URL de Maps
            const mapsButton = data.mapsUrl && data.mapsUrl.includes('http')
                ? `<a href="${data.mapsUrl}" class="maps-button" target="_blank" rel="noopener noreferrer">Ver Ubicaci√≥n en Google Maps</a>` 
                : '';

            // Crear secci√≥n de documentaci√≥n solo si hay al menos un documento
            const hasDocuments = data.imagenGeneral || data.imagenDetalle || data.pdfMontaje;
            
            let documentationSection = '';
            if (hasDocuments) {
                let docButtons = '';
                
                if (data.imagenGeneral && data.imagenGeneral.includes('http')) {
                    docButtons += `
                        <a href="${data.imagenGeneral}" class="doc-button image" target="_blank" rel="noopener noreferrer">
                            <span class="doc-icon">üñºÔ∏è</span>
                            <span>Ver Imagen General</span>
                        </a>
                    `;
                }
                
                if (data.imagenDetalle && data.imagenDetalle.includes('http')) {
                    docButtons += `
                        <a href="${data.imagenDetalle}" class="doc-button image" target="_blank" rel="noopener noreferrer">
                            <span class="doc-icon">üîç</span>
                            <span>Ver Imagen Detalle</span>
                        </a>
                    `;
                }
                
                if (data.pdfMontaje && data.pdfMontaje.includes('http')) {
                    docButtons += `
                        <a href="${data.pdfMontaje}" class="doc-button pdf" target="_blank" rel="noopener noreferrer">
                            <span class="doc-icon">üìÑ</span>
                            <span>Abrir PDF de Montaje</span>
                        </a>
                    `;
                }
                
                if (docButtons) {
                    documentationSection = `
                        <div class="section">
                            <div class="section-title">Documentaci√≥n T√©cnica</div>
                            <div class="doc-grid">
                                ${docButtons}
                            </div>
                        </div>
                    `;
                }
            }

            // Renderizar datos completos
            document.getElementById('app').innerHTML = `
                <div class="header">
                    <div class="header-logo">
                        <div class="logo-symbol">
                            <div class="logo-circle"></div>
                            <svg width="50" height="50" viewBox="0 0 80 80" style="position: absolute; top: 0; left: 0;">
                                <path d="M 15,15 L 18,13 L 21,15 L 21,19 L 18,21 L 15,19 Z" fill="none" stroke="#00D4AA" stroke-width="1.5" class="logo-element" style="animation-delay: -1s;"/>
                                <path d="M 59,15 L 62,13 L 65,15 L 65,19 L 62,21 L 59,19 Z" fill="none" stroke="#FF6B4A" stroke-width="1.5" class="logo-element" style="animation-delay: -2s;"/>
                                <rect x="28" y="28" width="12" height="12" fill="none" stroke="#0EA5E9" stroke-width="1.5" class="logo-element" style="animation-delay: -3s;"/>
                                <rect x="45" y="45" width="15" height="7" fill="none" stroke="#F59E0B" stroke-width="1.5" class="logo-element" style="animation-delay: -4s;"/>
                                <rect x="15" y="60" width="6" height="6" fill="none" stroke="#00D4AA" stroke-width="1.5" class="logo-element" style="animation-delay: -5s;"/>
                                <path d="M 59,60 L 62,58 L 65,60 L 65,64 L 62,66 L 59,64 Z" fill="none" stroke="#FF6B4A" stroke-width="1.5" class="logo-element" style="animation-delay: -6s;"/>
                            </svg>
                        </div>
                        <h1>CUEVA</h1>
                    </div>
                    <p>Sistema de Trazabilidad</p>
                </div>
                
                <div class="content">
                    <div class="highlight-box">
                        ${data.proyecto} - Pieza ${data.pieza}
                    </div>
                    
                    <div class="section">
                        <div class="section-title">Informaci√≥n del Elemento</div>
                        <div class="info-row">
                            <span class="label">Proyecto</span>
                            <span class="value">${data.proyecto}</span>
                        </div>
                        <div class="info-row">
                            <span class="label">Tipo</span>
                            <span class="value">${data.tipo}</span>
                        </div>
                        <div class="info-row">
                            <span class="label">Pieza</span>
                            <span class="value">${data.pieza}</span>
                        </div>
                        <div class="info-row">
                            <span class="label">Fabricaci√≥n</span>
                            <span class="value">${data.fabricacion}</span>
                        </div>
                        <div class="info-row">
                            <span class="label">Ubicaci√≥n/Lote</span>
                            <span class="value">${data.ubicacion}</span>
                        </div>
                        <div class="info-row">
                            <span class="label">Posicionamiento</span>
                            <span class="value">${data.posicionamiento}</span>
                        </div>
                    </div>
                    
                    ${documentationSection}
                    
                    <div class="section">
                        <div class="section-title">Trazabilidad</div>
                        <div class="info-row">
                            <span class="label">Fecha Generaci√≥n</span>
                            <span class="value">${data.fecha}</span>
                        </div>
                        <div class="info-row">
                            <span class="label">Hora Generaci√≥n</span>
                            <span class="value">${data.hora}</span>
                        </div>
                        <div class="info-row">
                            <span class="label">Generado Por</span>
                            <span class="value">${data.generadoPor}</span>
                        </div>
                        <div class="info-row">
                            <span class="label">Cargo</span>
                            <span class="value">${data.cargo}</span>
                        </div>
                        <div class="info-row">
                            <span class="label">Instalaci√≥n</span>
                            <span class="value">${data.instalacion}</span>
                        </div>
                    </div>
                    
                    <div class="section">
                        <div class="section-title">Identificador √önico</div>
                        <div class="uuid-box">
                            <div class="uuid-value">${data.uuid}</div>
                        </div>
                    </div>
                    
                    ${mapsButton}
                </div>
                
                <div class="footer">
                    <div class="footer-logo">CUEVA</div>
                    <div>Sistema Universal de Trazabilidad ¬© 2025</div>
                </div>
            `;
        }

        renderData();
    </script>
</body>
</html>
